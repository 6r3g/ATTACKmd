Tactics: [[DEFENSE_EVASION]]
Tags: #mitre/attack/techniques/T1027  

# Obfuscated Files or Information - T1027
---
## Description
[more on T1027](https://attack.mitre.org/techniques/T1027)

Adversaries may attempt to make an executable or file difficult to discover or analyze by encrypting, encoding, or otherwise obfuscating its contents on the system or in transit. This is common behavior that can be used across different platforms and the network to evade defenses.

Payloads may be compressed, archived, or encrypted in order to avoid detection. These payloads may be used during Initial Access or later to mitigate detection. Sometimes a user's action may be required to open and [[T1140_Deobfuscate-Decode Files or Information|Deobfuscate/Decode Files or Information (T1140)]] for [[T1204_User Execution|User Execution (T1204)]]. The user may also be required to input a password to open a password protected compressed/encrypted file that was provided by the adversary. [1](https://www.volexity.com/blog/2016/11/09/powerduke-post-election-spear-phishing-campaigns-targeting-think-tanks-and-ngos/) Adversaries may also used compressed or archived scripts, such as JavaScript.

Portions of files can also be encoded to hide the plain-text strings that would otherwise help defenders with discovery. [2](https://www.welivesecurity.com/2013/04/26/linuxcdorked-new-apache-backdoor-in-the-wild-serves-blackhole/) Payloads may also be split into separate, seemingly benign files that only reveal malicious functionality when reassembled. [3](https://www.carbonblack.com/2016/09/23/security-advisory-variants-well-known-adware-families-discovered-include-sophisticated-obfuscation-techniques-previously-associated-nation-state-attacks/)

Adversaries may also obfuscate commands executed from payloads or directly via a [[T1059_Command and Scripting Interpreter|Command and Scripting Interpreter (T1059)]]. Environment variables, aliases, characters, and other platform/language specific semantics can be used to evade signature based detections and application control mechanisms. [4](https://www.fireeye.com/blog/threat-research/2017/06/obfuscation-in-the-wild.html) [5](https://www.fireeye.com/content/dam/fireeye-www/blog/pdfs/revoke-obfuscation-report.pdf)[6](https://researchcenter.paloaltonetworks.com/2017/03/unit42-pulling-back-the-curtains-on-encodedcommand-powershell-attacks/)

---
## Sub-Techniques

#### Binary Padding - T1027.001
[more on T1027.001](https://attack.mitre.org/techniques/T1027/001)

Adversaries may use binary padding to add junk data and change the on-disk representation of malware. This can be done without affecting the functionality or behavior of a binary, but can increase the size of the binary beyond what some security tools are capable of handling due to file size limitations.

Binary padding effectively changes the checksum of the file and can also be used to avoid hash-based blocklists and static anti-virus signatures.[1](https://www.welivesecurity.com/2018/03/13/oceanlotus-ships-new-backdoor/) The padding used is commonly generated by a function to create junk data and then appended to the end or applied to sections of malware.[2](https://securelist.com/old-malware-tricks-to-bypass-detection-in-the-age-of-big-data/78010/) Increasing the file size may decrease the effectiveness of certain tools and detection capabilities that are not designed or configured to scan large files. This may also reduce the likelihood of being collected for analysis. Public file scanning services, such as VirusTotal, limits the maximum size of an uploaded file to be analyzed.[3](https://www.virustotal.com/en/faq/)

#### Software Packing - T1027.002
[more on T1027.002](https://attack.mitre.org/techniques/T1027/002)

Adversaries may perform software packing or virtual machine software protection to conceal their code. Software packing is a method of compressing or encrypting an executable. Packing an executable changes the file signature in an attempt to avoid signature-based detection. Most decompression techniques decompress the executable code in memory. Virtual machine software protection translates an executable's original code into a special format that only a special virtual machine can run. A virtual machine is then called to run this code.[1](https://www.welivesecurity.com/wp-content/uploads/2018/01/WP-FinFisher.pdf)

Utilities used to perform software packing are called packers. Example packers are MPRESS and UPX. A more comprehensive list of known packers is available, [2](http://en.wikipedia.org/wiki/Executable_compression) but adversaries may create their own packing techniques that do not leave the same artifacts as well-known packers to evade defenses.

#### Steganography - T1027.003
[more on T1027.003](https://attack.mitre.org/techniques/T1027/003)

Adversaries may use steganography techniques in order to prevent the detection of hidden information. Steganographic techniques can be used to hide data in digital media such as images, audio tracks, video clips, or text files.

[Duqu](https://attack.mitre.org/software/S0038) was an early example of malware that used steganography. It encrypted the gathered information from a victim's system and hid it within an image before exfiltrating the image to a C2 server.[1](https://en.wikipedia.org/wiki/Duqu)

By the end of 2017, a threat group used `Invoke-PSImage` to hide [[T1059_Command and Scripting Interpreter#PowerShell - T1059 001|PowerShell (T1059.001)]] commands in an image file (.png) and execute the code on a victim's system. In this particular case the [[T1059_Command and Scripting Interpreter#PowerShell - T1059 001|PowerShell (T1059.001)]] code downloaded another obfuscated script to gather intelligence from the victim's machine and communicate it back to the adversary.[2](https://securingtomorrow.mcafee.com/mcafee-labs/malicious-document-targets-pyeongchang-olympics/)

#### Compile After Delivery - T1027.004
[more on T1027.004](https://attack.mitre.org/techniques/T1027/004)

Adversaries may attempt to make payloads difficult to discover and analyze by delivering files to victims as uncompiled code. Text-based source code files may subvert analysis and scrutiny from protections targeting executables/binaries. These payloads will need to be compiled before execution; typically via native utilities such as csc.exe or GCC/MinGW.[1](https://www.clearskysec.com/wp-content/uploads/2018/11/MuddyWater-Operations-in-Lebanon-and-Oman.pdf)

Source code payloads may also be encrypted, encoded, and/or embedded within other files, such as those delivered as a [[T1566_Phishing|Phishing (T1566)]]. Payloads may also be delivered in formats unrecognizable and inherently benign to the native OS (ex: EXEs on macOS/Linux) before later being (re)compiled into a proper executable binary with a bundled compiler and execution framework.[2](https://blog.trendmicro.com/trendlabs-security-intelligence/windows-app-runs-on-mac-downloads-info-stealer-and-adware/)

#### Indicator Removal from Tools - T1027.005
[more on T1027.005](https://attack.mitre.org/techniques/T1027/005)

Adversaries may remove indicators from tools if they believe their malicious tool was detected, quarantined, or otherwise curtailed. They can modify the tool by removing the indicator and using the updated version that is no longer detected by the target's defensive systems or subsequent targets that may use similar systems.

A good example of this is when malware is detected with a file signature and quarantined by anti-virus software. An adversary who can determine that the malware was quarantined because of its file signature may modify the file to explicitly avoid that signature, and then re-use the malware.

#### HTML Smuggling - T1027.006
[more on T1027.006](https://attack.mitre.org/techniques/T1027/006)

Adversaries may smuggle data and files past content filters by hiding malicious payloads inside of seemingly benign HTML files. HTML documents can store large binary objects known as JavaScript Blobs (immutable data that represents raw bytes) that can later be constructed into file-like objects. Data may also be stored in Data URLs, which enable embedding media type or MIME files inline of HTML documents. HTML5 also introduced a download attribute that may be used to initiate file downloads.[1](https://www.menlosecurity.com/blog/new-attack-alert-duri)[2](https://outflank.nl/blog/2018/08/14/html-smuggling-explained/)

Adversaries may deliver payloads to victims that bypass security controls through HTML Smuggling by abusing JavaScript Blobs and/or HTML5 download attributes. Security controls such as web content filters may not identify smuggled malicious files inside of HTML/JS files, as the content may be based on typically benign MIME types such as `text/plain` and/or `text/html`. Malicious files or data can be obfuscated and hidden inside of HTML files through Data URLs and/or JavaScript Blobs and can be deobfuscated when they reach the victim (i.e. [[T1140_Deobfuscate-Decode Files or Information|Deobfuscate/Decode Files or Information (T1140)]]), potentially bypassing content filters.

For example, JavaScript Blobs can be abused to dynamically generate malicious files in the victim machine and may be dropped to disk by abusing JavaScript functions such as `msSaveBlob`.[1](https://www.menlosecurity.com/blog/new-attack-alert-duri)[3](https://www.microsoft.com/security/blog/2021/05/27/new-sophisticated-email-based-attack-from-nobelium/)[2](https://outflank.nl/blog/2018/08/14/html-smuggling-explained/)[4](https://research.nccgroup.com/2017/08/08/smuggling-hta-files-in-internet-explorer-edge/)



