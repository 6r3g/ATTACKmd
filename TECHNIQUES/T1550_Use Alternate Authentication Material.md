Tactics: [[DEFENSE_EVASION]] - [[LATERAL_MOVEMENT]]
Tags: #mitre/attack/techniques/T1550  

# Use Alternate Authentication Material - T1550
---
## Description
[more on T1550](https://attack.mitre.org/techniques/T1550)

Adversaries may use alternate authentication material, such as password hashes, Kerberos tickets, and application access tokens, in order to move laterally within an environment and bypass normal system access controls.

Authentication processes generally require a valid identity (e.g., username) along with one or more authentication factors (e.g., password, pin, physical smart card, token generator, etc.). Alternate authentication material is legitimately generated by systems after a user or application successfully authenticates by providing a valid identity and the required authentication factor(s). Alternate authentication material may also be generated during the identity creation process.[1](https://csrc.nist.gov/glossary/term/authentication)[2](https://csrc.nist.gov/glossary/term/Multi_Factor-Authentication)

Caching alternate authentication material allows the system to verify an identity has successfully authenticated without asking the user to reenter authentication factor(s). Because the alternate authentication must be maintained by the system—either in memory or on disk—it may be at risk of being stolen through [[CREDENTIAL_ACCESS|Credential Access]] techniques. By stealing alternate authentication material, adversaries are able to bypass system access controls and authenticate to systems without knowing the plaintext password or any additional authentication factors.

---
## Sub-Techniques

#### Application Access Token - T1550.001
[more on T1550.001](https://attack.mitre.org/techniques/T1550/001)

Adversaries may use stolen application access tokens to bypass the typical authentication process and access restricted accounts, information, or services on remote systems. These tokens are typically stolen from users and used in lieu of login credentials.

Application access tokens are used to make authorized API requests on behalf of a user and are commonly used as a way to access resources in cloud-based applications and software-as-a-service (SaaS).[1](https://auth0.com/blog/why-should-use-accesstokens-to-secure-an-api/) OAuth is one commonly implemented framework that issues tokens to users for access to systems. These frameworks are used collaboratively to verify the user and determine what actions the user is allowed to perform. Once identity is established, the token allows actions to be authorized, without passing the actual credentials of the user. Therefore, compromise of the token can grant the adversary access to resources of other sites through a malicious application.[2](https://developer.okta.com/blog/2018/06/20/what-happens-if-your-jwt-is-stolen)

For example, with a cloud-based email service once an OAuth access token is granted to a malicious application, it can potentially gain long-term access to features of the user account if a "refresh" token enabling background access is awarded.[3](https://docs.microsoft.com/en-us/azure/active-directory/develop/access-tokens) With an OAuth access token an adversary can use the user-granted REST API to perform functions such as email searching and contact enumeration.[4](https://staaldraad.github.io/2017/08/02/o356-phishing-with-oauth/)

Compromised access tokens may be used as an initial step in compromising other services. For example, if a token grants access to a victim’s primary email, the adversary may be able to extend access to all other services which the target subscribes by triggering forgotten password routines. Direct API access through a token negates the effectiveness of a second authentication factor and may be immune to intuitive countermeasures like changing passwords. Access abuse over an API channel can be difficult to detect even from the service provider end, as the access can still align well with a legitimate workflow.

#### Pass The Hash - T1550.002
[more on T1550.002](https://attack.mitre.org/techniques/T1550/002)

Adversaries may "pass the hash" using stolen password hashes to move laterally within an environment, bypassing normal system access controls. Pass the hash (PtH) is a method of authenticating as a user without having access to the user's cleartext password. This method bypasses standard authentication steps that require a cleartext password, moving directly into the portion of the authentication that uses the password hash.

When performing PtH, valid password hashes for the account being used are captured using a [[CREDENTIAL_ACCESS|Credential Access]] technique. Captured hashes are used with PtH to authenticate as that user. Once authenticated, PtH may be used to perform actions on local or remote systems.

Adversaries may also use stolen password hashes to "overpass the hash." Similar to PtH, this involves using a password hash to authenticate as a user but also uses the password hash to create a valid Kerberos ticket. This ticket can then be used to perform [[T1550_Use Alternate Authentication Material#Pass the Ticket - T1550 003|Pass the Ticket (T1550.003)]] attacks.[1](https://stealthbits.com/blog/how-to-detect-overpass-the-hash-attacks/)

#### Pass The Ticket - T1550.003
[more on T1550.003](https://attack.mitre.org/techniques/T1550/003)

Adversaries may "pass the ticket" using stolen Kerberos tickets to move laterally within an environment, bypassing normal system access controls. Pass the ticket (PtT) is a method of authenticating to a system using Kerberos tickets without having access to an account's password. Kerberos authentication can be used as the first step to lateral movement to a remote system.

When preforming PtT, valid Kerberos tickets for [[T1078_Valid Accounts|Valid Accounts (T1078)]] are captured by [[T1003_OS Credential Dumping|OS Credential Dumping (T1003)]]. A user's service tickets or ticket granting ticket (TGT) may be obtained, depending on the level of access. A service ticket allows for access to a particular resource, whereas a TGT can be used to request service tickets from the Ticket Granting Service (TGS) to access any resource the user has privileges to access.[1](https://adsecurity.org/?p=556)[2](http://blog.gentilkiwi.com/securite/mimikatz/pass-the-ticket-kerberos)

A [[T1558_Steal or Forge Kerberos Tickets#Silver Ticket - T1558 002|Silver Ticket (T1558.002)]] can be obtained for services that use Kerberos as an authentication mechanism and are used to generate tickets to access that particular resource and the system that hosts the resource (e.g., SharePoint).[1](https://adsecurity.org/?p=556)

A [[T1558_Steal or Forge Kerberos Tickets#Golden Ticket - T1558 001|Golden Ticket (T1558.001)]] can be obtained for the domain using the Key Distribution Service account KRBTGT account NTLM hash, which enables generation of TGTs for any account in Active Directory.[3](http://defcon.org/images/defcon-22/dc-22-presentations/Campbell/DEFCON-22-Christopher-Campbell-The-Secret-Life-of-Krbtgt.pdf)

Adversaries may also create a valid Kerberos ticket using other user information, such as stolen password hashes or AES keys. For example, "overpassing the hash" involves using a NTLM password hash to authenticate as a user (i.e. [[T1550_Use Alternate Authentication Material#Pass the Hash - T1550 002|Pass the Hash (T1550.002)]]) while also using the password hash to create a valid Kerberos ticket.[4](https://stealthbits.com/blog/how-to-detect-overpass-the-hash-attacks/)

#### Web Session Cookie - T1550.004
[more on T1550.004](https://attack.mitre.org/techniques/T1550/004)

Adversaries can use stolen session cookies to authenticate to web applications and services. This technique bypasses some multi-factor authentication protocols since the session is already authenticated.[1](https://wunderwuzzi23.github.io/blog/passthecookie.html)

Authentication cookies are commonly used in web applications, including cloud-based services, after a user has authenticated to the service so credentials are not passed and re-authentication does not need to occur as frequently. Cookies are often valid for an extended period of time, even if the web application is not actively used. After the cookie is obtained through [[T1539_Steal Web Session Cookie|Steal Web Session Cookie (T1539)]] or [[T1606_Forge Web Credentials#Web Cookies - T1606 001|Web Cookies (T1606.001)]], the adversary may then import the cookie into a browser they control and is then able to use the site or application as the user for as long as the session cookie is active. Once logged into the site, an adversary can access sensitive information, read email, or perform actions that the victim account has permissions to perform.

There have been examples of malware targeting session cookies to bypass multi-factor authentication systems.[2](https://unit42.paloaltonetworks.com/mac-malware-steals-cryptocurrency-exchanges-cookies/)



